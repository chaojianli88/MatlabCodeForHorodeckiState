syms t;
syms a;
P=str2sym('[1/3,0,0,0,1/3,0,0,0,1/3;0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0;1/3,0,0,0,1/3,0,0,0,1/3;0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0;1/3,0,0,0,1/3,0,0,0,1/3]');
T=str2sym('[1/3,0,0,0,0,0,0,0,0;0,0,0,1/3,0,0,0,0,0;0,0,0,0,0,0,1/3,0,0;0,1/3,0,0,0,0,0,0,0;0,0,0,0,1/3,0,0,0,0;0,0,0,0,0,0,0,1/3,0;0,0,1/3,0,0,0,0,0,0;0,0,0,0,0,1/3,0,0,0;0,0,0,0,0,0,0,0,1/3]');
Q=str2sym('[0,0,0,0,0,0,0,0,0;0,a/5,0,0,0,0,0,0,0;0,0,(5-a)/5,0,0,0,0,0,0;0,0,0,(5-a)/5,0,0,0,0,0;0,0,0,0,0,0,0,0,0;0,0,0,0,0,a/5,0,0,0;0,0,0,0,0,0,a/5,0,0;0,0,0,0,0,0,0,(5-a)/5,0;0,0,0,0,0,0,0,0,0]');
%R=@(t)t*P+(1-t)*Q/3;
R=t*P+(1-t)*Q/3;
disp('R='),disp(R);% Original states
S=t*T+(1-t)*Q/3; %PPT states
disp('S='),disp(S);
[V,D] = eig(S);
disp('V='),disp(V);
disp('D='),disp(D);
[la,lb,lc,ld,le,lf,lg,lh,li] = deal(D(1,1),D(2,2),D(3,3),D(4,4),D(5,5),D(6,6),D(7,7),D(8,8),D(9,9));
disp('la='),disp(la);
disp('lb='),disp(lb);
disp('lc='),disp(lc);
disp('ld='),disp(ld);
disp('le='),disp(le);
disp('lf='),disp(lf);
disp('lg='),disp(lg);
disp('lh='),disp(lh);
disp('li='),disp(li);
hold on;
C=str2sym('[t/3,0,0,0,-(a*(t - 1))/15,0,0,0,((a-5)*(t-1))/15;0,t/3,0,0,0,0,0,0,0;0,0,t/3,0,0,0,0,0,0;0,0,0,t/3,0,0,0,0,0;((a-5)*(t-1))/15,0,0,0,t/3,0,0,0,-(a*(t-1))/15;0,0,0,0,0,t/3,0,0,0;0,0,0,0,0,0,t/3,0,0;0,0,0,0,0,0,0,t/3,0;-(a*(t-1))/15,0,0,0,((a-5)*(t-1))/15,0,0,0,t/3]');%CCNR states
disp('C='),disp(C);
N=C*(C.');
[V,D]=eig(N);
disp('V='),disp(V);
disp('D='),disp(D);
[la,lb,lc,ld,le,lf,lg,lh,li] = deal(D(1,1),D(2,2),D(3,3),D(4,4),D(5,5),D(6,6),D(7,7),D(8,8),D(9,9));
z=la.^(1/2)+lb.^(1/2)+lc.^(1/2)+ld.^(1/2)+le.^(1/2)+lf.^(1/2)+lg.^(1/2)+lh.^(1/2)+li.^(1/2);
disp('z='),disp(z);
[t]=solve(z-1==0,t);
disp('t='),disp(t);
